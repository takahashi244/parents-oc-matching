---

doc_type: product_spec
product: 保護者OCマッチング（仮）
version: 1.1-final
owner: Taka244（PM）
updated: 2025-09-28
status: ready_for_submission

---

# 1. プロダクト概要

保護者が主導して子どもの“うっすらした興味”を整理し、マッチングされた学部・学科およびオープンキャンパス（OC）候補を理由付きで提示するウェブサービス。診断→候補共有→OC参加メモ→レビュー公開という循環を最小実装し、レビューが蓄積した後に検索機能を段階的に解禁する。

# 2. 想定ユーザーと主な利用シナリオ

| ユーザー | 利用シーン | 得たい価値 |
|----------|------------|-------------|
| 保護者   | 子どもの興味を整理し進路の選択肢を得たい時 | 3分で診断を完了し、理由付きの候補と行動プランを把握できる |
| 子ども   | 保護者と議論しながら自分の興味を再確認 | 候補の背景や体験内容を把握し、自発的な参加意欲を高める |
| チーム運営者 | レビューを収集し、改善の判断材料を得る | 管理画面なしでもシードデータとレビューで仮説検証を進める |

# 3. 提供機能一覧

| カテゴリ | 主要機能 | 利用可否 |
|-----------|-----------|-----------|
| 診断      | 興味カテゴリ・好き科目・尊敬人物・居住地入力（複数選択可、自由記述あり） | ✅ 本番稼働 |
| マッチング | 上位5候補の学部学科＋推奨OC、3つ以上の理由タグ表示、スコア | ✅ 本番稼働 |
| 共有      | 候補共有リンク生成、7日限定シェアリンク | ✅ 本番稼働 |
| OC詳細     | 日程・場所・予約導線、診断理由再掲、親子向けメモ導線 | ✅ 本番稼働 |
| 内見メモ   | 親用・子用メモ、保存済み内容の再編集 | ✅ 本番稼働 |
| レビュー公開 | 親用メモ→確認画面→公開、学校別一覧表示 | ✅ 本番稼働 |
| 学校一覧／レビュー検索 | エリア／学問カテゴリで絞り込み閲覧 | ✅ 本番稼働（サンプルデータ） |
| ログイン／認証 | 保護者アカウント、子どもサブユーザー | ✅ 本番稼働 |
| 検索（自由検索） | 学校・学科検索 | 🚧 Feature Flag OFF（開発中） |
| レビュー自動モデレーション | NGワード検知、自動公開制御 | 🚧 βで導入予定 |

# 4. How To Use（画面別操作ガイド）

## 4.1 トップ / 興味診断フォーム

- **URL**: `/`
- **操作手順**
  1. 「3分で診断を始める」をクリックし診断フォームへ遷移。
  2. 興味ジャンルを複数選択（各カテゴリはアコーディオン内）。理由テキストを参考に保護者が聞き出しながら選択する。
  3. 好きな科目、尊敬人物カテゴリと自由記述、居住地、入力者（保護者/子ども）を順番に入力。
  4. フォーム最下部で注意事項に同意し「診断結果を見る」をクリック。
- **入力ガイド**
  - 興味カテゴリと好き科目は複数選択可。尊敬人物の自由記述は任意。
  - 住所情報は予約動線の距離調整に利用。
- **完了トリガー**: POST `/match` 成功後、候補結果ページへ遷移。

## 4.2 マッチ結果ページ（`/match-results`）

- **表示内容**
  - 上位5件の候補カード。学校・学科名、総合スコア、主要理由、他のチェックポイント。
  - 「OC候補を見る」ボタンで OC 詳細ページへ。
  - 共有リンク作成フォーム。
- **ユーザー動線**
  1. 候補カードを確認し、子どもとどれに興味があるか話し合う。
  2. 共有リンクを作成→家族チャットやLINEで共有。
  3. 興味がある候補の「OC候補を見る」をクリックし詳細へ遷移。
- **注意点**
  - 共有リンクは7日間有効。期限切れ画面で再診断導線を案内。

## 4.3 OC詳細ページ（`/oc/{id}`）

- **表示内容**
  - 日程、会場、予約先リンク、診断理由再掲。
  - 親用・子用メモ導線、公開レビュー導線。
- **操作**
  1. 「公式サイトで予約する」で外部予約サイトへ。
  2. OC参加後、「親用レビューを記入する」「子ども用メモを記入する」でメモフォームへ。
- **ポイント**
  - 予約前後に診断理由を再確認することで一家の納得感を醸成。

## 4.4 親用メモ（`/oc/{id}/memo-parent`）

- **入力項目**: 総合評価（1〜5）、良かった点／気になった点、チェック項目、同意チェック。
- **保存フロー**
  1. フォーム入力後「レビューを確認する」。
  2. 確認画面で内容をチェックし「この内容で公開する」でレビュー一覧へ公開。
- **Tips**
  - 保存済みメモがあれば先頭に表示、追記して再保存可能。
  - 公開時は注意喚起に同意しないと投稿不可。

## 4.5 子ども用メモ（`/oc/{id}/memo-child`）

- **目的**: 子ども視点で感じた点を数分で残せるように設計。
- **操作**: 評価（1〜5）をドロップダウンで選択、自由コメント、保存ボタン。
- **利用方法**: 保存した内容は親子の振り返りや将来のレビュー更新に利用。

## 4.6 レビュー確認 & 公開（`/oc/review-confirm`）

- 親用メモの内容を一覧表示し、修正リンクと公開ボタンを配置。
- 公開後は学校別ページに反映され、レビュー一覧から閲覧可能。

## 4.7 学校別レビュー検索（`/reviews`）

- **現在の状態**: サンプルデータで動作確認済み。キーワード検索は未実装。
- **利用方法**
  1. 学校一覧からエリア・学問カテゴリのフィルタを選択。
  2. 評価平均やレビュー件数を確認し、詳細で本文を読む。

# 5. システム構成メモ

- フロント: Laravel Blade + Tailwind CSS + Alpine.js、Viteでビルド。
- バックエンド: Laravel 12（PHP 8.2）、本番は AWS Lightsail/Bitnami LAMP 上の MariaDB 10.6、ローカル開発は Laravel Sail の MySQL 8.0。
- ホスティング: AWS Lightsail (Linux + Apache + PHP 8.3)。デプロイは `git pull` → `npm run build` → `php artisan migrate --force` などの手動手順。
- データ投入: `php artisan db:seed --class=InitSeeder --force`（CSV からサンプルデータを投入）。
- ログイン/認証: Laravel Breeze（メール+パスワード）。

# 6. データ項目と連携

| テーブル | 主要カラム | 備考 |
|----------|------------|------|
| `schools` | `school_id`, `school_name`, `school_type`, `prefecture` | CSVで投入。`school_type` は `national/private` などテキスト。|
| `departments` | `dept_id`, `school_id`, `dept_name`, `tags`, `summary` | `tags` はセミコロン区切り文字列。|
| `oc_events` | `ocev_id`, `dept_id`, `date`, `place`, `reservation_url` | OC詳細画面の元データ。|
| `reviews` | `review_id`, `ocev_id`, `author_role`, `pros`, `cons`, `rating`, `is_published` | 親用メモが公開されたデータ。|
| `match_results`(仮) | API/セッションで保持。`MatchEngine` サービスで生成。|

# 7. 運用手順（再デプロイ時）

1. GitHub main ブランチに変更をプッシュ。
2. Lightsail スナップショットを取得しロールバック準備。
3. SSH でサーバーに接続し、`git pull origin main`。
4. `composer install --no-dev --optimize-autoloader` → `npm ci` → `npm run build`。
5. `php artisan migrate --force`（必要なら）→ `php artisan db:seed --class=InitSeeder --force`（サンプル更新時）。
6. `php artisan config:cache` → `php artisan route:cache` → `sudo /opt/bitnami/ctlscript.sh restart`。
7. ブラウザ確認、ログ監視（`storage/logs/laravel.log`）。

# 8. 開発中・未対応機能の明記

- 自由検索機能（学校検索・テキスト検索）は Feature Flag OFF。UI には導線を出していない。
- レビュー自動モデレーション、違反報告フォームはβリリースで導入予定。現在は手動確認。
- 先生向けビュー、学校公式コメント機能は未実装。

# 9. 変更履歴

| バージョン | 日付 | 変更内容 |
|------------|------|----------|
| v1.1-final | 2025-09-28 | How To Use を追加。画面別操作ガイド、運用手順、未実装一覧を整理。|
| v1.0-draft | 2025-09-26 | 初稿（PRD v1.0 をベースに卒業提出向けに統合）。|

# 10. 添付・参考

- 画面キャプチャ: `docs/screenshots/20250927/*`
- マッチング仕様詳細: `docs/02_PRD_プロダクト要求仕様書/prd_v_1_1_draft.md`
- デザインガイドライン: `docs/06_デザインガイドライン/style_guide_v0_1.md`
