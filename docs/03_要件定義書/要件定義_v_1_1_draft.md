---
doc_type: system_requirements
system: 保護者OCマッチング（仮）
version: 1.1-draft
owner: Taka244（PM）
source_of_truth: PRD_v1.0_draft（canvas最新版）
updated: 2025-09-26
---

# 0. はじめに（読み方）
専門用語を避けて書いています。各項目は**チェックボックス**で進行管理できます。困ったら「目的→受け入れ基準→ToDo」の順だけ確認すればOKです。

# 1. 機能要件（FR）
| ID | 機能 | 説明 | 優先度 | 関連US | 受け入れ基準（PRD参照） |
|---|---|---|---|---|---|
| FR-001 | 興味ベース診断 | 音楽/アニメ/英語/数学/歴史/スポーツ/尊敬人物などを多選択＋自由入力（3分以内） | MUST | US-001/002 | AC-001 |
| FR-002 | 簡易マッチングv0 | 学部学科・OC候補を上位5件＋**理由タグ≥3**で提示 | MUST | US-001 | AC-002 |
| FR-003 | 候補共有（リンク/QR） | 親→子（または逆）に候補を共有。受け手はログイン不要で閲覧可 | MUST | US-003 | AC-003 |
| FR-004 | OC候補詳細＆予約遷移 | 候補先のOC詳細（日時/場所/予約URL）表示→外部サイトで予約 | MUST | フロー#4 | ー |
| FR-005 | 内見メモ（親/子） | 親子別画面で10±3項目の数値評価を入力。親用画面では同時に総合評価とコメントを記入 | MUST | US-004 | AC-004 |
| FR-006 | レビュー公開（親用確認） | 親用画面で総合評価・良かった点・気になった点を入力し、確認画面を経て公開（初期は目視で確認） | MUST | US-005 | AC-005 |
| FR-015 | 学校別レビュー一覧 | 学校ごとにレビュー/平均評価/件数を表示し、学校トップからエリア・系統で探せる | MUST | US-005/006 | AC-007 |
| FR-007 | 認証と同意 | 保護者/子どもアカウント、未成年の同意、最小の個人情報 | MUST | 全体 | AC-006（説明表示） |
| FR-008 | イベント計測 | interest_submit / match_view / share_open / oc_memo_create / review_publish | MUST | 全体 | ー |
| FR-009 | 検索の段階解禁 | 地域別Feature Flagで検索ON/OFF（初期はOFF） | SHOULD→GA条件でMUST | 全体 | 解禁条件（#11） |
| FR-010 | キャリア物語3パターン | OC候補から**将来の職業ストーリー**を3案自動提示（会話きっかけ） | SHOULD | ー | ー |
| FR-011 | 先生向け共有ビューLite | 保護者同意の候補閲覧（将来） | SHOULD | US-006 | ー |
| FR-012 | 学校公式コメント | 誤認の補足/修正（将来） | SHOULD | US-007 | ー |
| FR-013 | 自動モデレーション（簡易フィルタ） | 誹謗中傷/個人情報の自動検知（NG語辞書など） | SHOULD | 全体 | ー |
| FR-014 | 通報フォーム＆SLA | 報告フォーム、審査キュー、SLA（3営業日） | SHOULD | 全体 | ー |
| FR-016 | 子ども向け共有体験 | 共有URL経由で子どもが診断→内見メモ→レビュー投稿まで誘導 | SHOULD | US-002 | ー |

> **メモ**：検索はレビュー蓄積後に解禁。初期はマッチ結果からの**限定導線**のみ。

# 2. 非機能要件（NFR）
- 性能：p95 API応答 < 500ms（MVP範囲・**暫定**。利用増に応じて引き上げ可能）。
- 安定性：想定同時利用 100人（α）→ 500人（β）。
- プライバシー：データ最小化、保存期間の明記、削除要求に対応。ログは匿名ID。
- 安全：**初期は目視運用**（公開前/通報後のレビュー）。**自動フィルタ/通報フォームはSHOULD**（βで導入を検討）。

# 3. データモデル（ERD概要）
| エンティティ | 主キー | 主な属性 |
|---|---|---|
| User | u_id | role(parent/student), consent, created_at |
| InterestProfile | ip_id | user_id, tags[], updated_at |
| SchoolDepartment | dept_id | school_id, tags[], summary |
| OCEvent | ocev_id | dept_id, date, url, place |
| Match | match_id | user_id, candidates[{dept_id, ocev_id, score, reasons[]}] |
| Review | rev_id | ocev_id, author_role, pros[], cons[], notes, rating |

# 4. API/IF概要（最小）
| API | メソッド | 入力 | 出力 | 備考 |
|---|---|---|---|---|
| /interests | POST | {tags[], hero?} | 200 | FR-001 |
| /match | GET | user_id | {candidates[]} | FR-002 |
| /share/:id | GET | token | HTML | ログイン不要閲覧（FR-003） |
| /ocevents/:id | GET | ocev_id | {date, url, place} | FR-004 |
| /oc/{id}/memo/parent | POST | {ratings[], overall_rating, good_text, concern_text, agree_terms} | 302（公開ページへリダイレクト） | FR-005/006 |
| /oc/{id}/memo/child | POST | {ratings[], agree_terms} | 302（OC詳細へ戻る） | FR-005 |
| /moderation/check | POST | {text} | {ok|flag, reasons[]} | FR-006 |

# 5. 権限/ロール
- **保護者**：興味入力/共有/メモ/レビュー投稿
- **子ども**：興味入力/メモ/レビュー投稿
- **先生（将来）**：共有ビュー閲覧のみ（保護者同意必須）
- **学校（将来）**：公式コメント投稿（審査あり）

# 6. 運用（モデレーション/通報）
- **初期（α）**：目視運用。公開前レビュー（スポットチェック）＋通報受領はメール/簡易フォーム（スプレッドシート管理）。
- **β以降**：FR-013（自動フィルタ）とFR-014（通報フォーム＆SLA）を導入。通報→審査キュー→判定（公開維持/一時非表示/編集依頼）。
- 通報種別：個人情報 / 誹謗中傷 / 虚偽 / 著作権。
- 目標SLA：3営業日以内（β以降に適用）。


# 7. テスト観点（抜粋）
- 診断の平均所要時間≤180秒／理由タグが必ず≥3表示。
- 共有リンクで未ログイン閲覧可、編集時は要ログイン。
- 親用メモで入力した総合評価とコメントが確認画面を経て公開される。
- （β以降）自動モデレーションフィルタがNGワードでブロックする。

# 8. 除外事項（WON'T）
- 適性検査、合否予測、SNSタイムラインは実装しない（PRD準拠）。

# 9. マイルストーンと依存
- α：FR-001〜008を完成。
- β：FR-006のUX改善、**FR-013/FR-014（自動フィルタ/通報フォーム）導入**、FR-010（キャリア物語）試験導入。
- GA：レビュー指標達成後、FR-009（検索）を地域単位で解禁。

# 10. 作業ToDo（進行用チェックリスト）
- [ ] 興味タグ初期セット（10〜14個）確定（OQ-001）
- [ ] 検索解禁の地域単位決定（OQ-002）
- [ ] レビュー公開フィルタの基準確定（OQ-003）
- [ ] 画面文言ドラフト（診断/理由/共有/レビュー注意）

# 11. 変更履歴
- v1.2-draft（2025-09-26）親用メモ送信後に確認画面を挟む仕様に合わせ、API/テスト観点を更新。
- v1.1-draft（2025-09-15）モデレーションは初期“目視”に変更。自動フィルタ/通報フォームをSHOULD（FR-013/FR-014）に分離。NFRの性能を暫定値として明記。
- v1.0-draft（2025-09-15）PRD（canvas最新版）の修正点を反映して初稿作成（キャリア物語3案をSHOULDに追加、OC予約遷移を明記）。
