---
doc_type: adr
id: ADR-001
status: Accepted
owner: Taka244（PM）
decision_date: 2025-09-28
context_timezone: Asia/Tokyo
---

# タイトル
MVP実装スタックの確定（Laravel 12 + Blade + Tailwind + **MariaDB 10.6 / MySQL 8.0**）

# 決定（Decision）
- **アプリケーション**：**Laravel 12**（PHP 8.2）を基盤とし、サービス全体をモノリシックに構築する。
- **UIレイヤ**：**Blade + Tailwind CSS + Alpine.js**。Vite をビルドチェーンとして採用し、CSS/JS を1ビルドにまとめる。
- **認証**：**Laravel Breeze**（メール+パスワード）。将来のLINEログインなど拡張余地を残す。
- **データベース**：本番は **AWS Lightsail（Bitnami LAMP）の MariaDB 10.6**。ローカル・自動テストでは Laravel Sail の **MySQL 8.0** を使用し、互換性を確保する。
- **ホスティング**：AWS Lightsail（Linux＋Apache＋PHP 8.3）。デプロイは Git pull + ビルド + `art migrate` の手動手順で運用する。
- **計測**：`event_logs` テーブルへサーバーサイドで挿入（`App\Support\Analytics`）。β以降に外部分析基盤へ移行予定。
- **Feature Flag**：`config/features.php` と `.env` を組み合わせ、検索等をトグル制御。将来は GrowthBook 等のサービスでの運用を検討。

# 背景（Context）
- PMは**非エンジニア**。既知のスキル：HTML/CSS/JS、**Tailwind**は手本があれば対応可。**Laravelで作りたい**希望あり。
- MVPは検索を出さず、**診断→マッチ→OC→内見メモ→レビュー**の循環に集中。スピードと変更容易性が重要。実装は Laravel Sail をベースに開始したが、早期に Lightsail へ移行して実運用を開始した。

# 根拠（Rationale / Decision Drivers）
1. **学習コストが低い**：Blade/TailwindによりHTML駆動で実装でき、PM主導でもUI更新しやすい。
2. **モノリシックで高速開発**：API分離よりも MVP 到達を優先。将来の分割は Service 層とイベントログで吸収する設計。
3. **インフラのシンプルさ**：Lightsail（Bitnami LAMP）が MariaDB を標準提供し、メンテコストが低い。
4. **MySQL/MariaDB 互換の拡張性**：JSON カラム（長文タグ）や全文検索(将来)の活用が可能。
5. **エコシステムと支援情報が豊富**：Laravel 12 / Tailwind / MariaDB は日本語情報が多く、サポートを受けやすい。

# トレードオフ / 代替案
- **PostgreSQL 15**：JSONBや正規表現検索が強力だが、Lightsail LAMPでは非標準。PM の運用負荷を考えて見送り。
- **完全な Docker 運用**：Sail で一貫運用も可能だが、Lightsail の固定IP・簡易バックアップのメリットを優先し本番は VM 運用にした。
- **SPA（React/Vue）**：UI拡張の自由度は高いが、開発コストとデプロイ手順が増える。現状は Blade で十分に要件を満たす。

# 影響（Consequences）
- UI は Blade/Alpine 中心で実装し、インタラクションは最小限に抑える（必要時に Livewire を追加）。
- 計測は `event_logs` テーブルに蓄積し、レビュー取得などの KPI を SQL で算出する。外部BIへ接続しやすいよう JSON カラムで保存。
- 本番デプロイは Git pull + npm build + artisan コマンドを手動で実行。自動化までの間は手順書に従う。
- MariaDB に依存するため、一部 MySQL 8.0 固有機能（インビジブルインデックス等）は利用できない。

# フォローアップ事項（このADRから派生済み/継続）
- ✅ マイグレーションとシード CSV を整備（2025-09-27）
- ✅ `event_logs` テーブルと `App\Support\Analytics` を実装
- ☐ デプロイ自動化（Lightsail + GitHub Actions）
- ☐ 検索 Feature Flag ON 条件の自動評価バッチ
- ☐ BI 連携（Metabase/PostHogなど）検討

# リスクと対応
- Livewire 依存の増加 → **Blade/Alpine** を基本とし、リッチUI要求が出るまで導入しない。
- MariaDB 固有癖 → MySQL 8.0 互換を意識し、CI では MySQL 8.0 を継続利用。移行時は `schema:dump` を活用。

# 変更履歴
- v1.2（2025-09-28）本番環境を Lightsail + MariaDB に更新、Laravel 12 / Vite / Analytics 仕様を反映。ToDo をフォローアップ項目に刷新。
- v1.1（2025-09-15）DBを**MySQL 8.0**に変更（Sail標準・学習コスト低減のため）。
- v1.0（2025-09-15）初版・PostgreSQL 15で作成。
